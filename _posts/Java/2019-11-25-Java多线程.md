---
layout:     post
title:      Java多线程
subtitle:   Java多线程
date:       2019-11-24
author:     正版慕言
header-img: img/blog_bg_1.jpg
catalog: true
mathjax: true
tags:
    - 多线程
    - Java

---

# 线程的命名与取得

为了在程序开发中获取到需要的线程，需要根据名称来操作。

Thread类中提供了关于线程名称的操作

- 构造方法：public Thread(Runnable target, String name);
- 设置名字：public final void setName(String name);
- 取得名字：public final String getName();

线程的状态是不确定的，但所有的线程一定会执行run()方法。因此，可以通过获取当前线程来获取线程名字。
- 获取当前线程：public static Thread currentThread();
- 所以，Thread.currentThread().getName();

主方法也是一个线程。

# 线程休眠

希望某线程暂缓执行一次。

在Thread中的休眠方法：
- public static void sleep(long millis) throws InterruptedException
- public static void sleep(long millis, int nanos) throws InterruptedException

sleep()的中断异常必须进行处理。

休眠的特点：结束后自动实现线程的唤醒以继续进行后续处理。当有多个线程对象时，休眠有先后顺序。

# 线程中断

线程中断是由其他线程造成的。

- 判断线程是否被中断：public boolean isInterrupted();
- 中断线程执行：public void interrupt();

所有正在执行的线程都可以被中断，中断的线程要进行异常处理。

# 线程强制运行

当满足某些条件之后，某个线程对象将一直独占资源一直到执行结束。

Thread类中的强制执行方法
- public final void join() throws InterruptedException

# 线程礼让

线程礼让指现将资源让出去让别的线程先执行。

Thread中的yield方法
- public static void yield()

礼让执行时每次调用yield方法只会礼让一次当前线程的资源。

# 线程优先级

理论上，线程优先级越高越可能先执行(月可能先抢占到资源)。

Thread类中提供了两个方法：
- 设置优先级：public final void setPriority(int new Priorithy)
- 获取优先级：public final int getPriority()

优先级定义通过int型数字完成。
- 最高优先级：public static final int MAX_PRIORITY（10）
- 中等优先级：public static final int NORM_PRIORITY（5）
- 最低优先级：public static final int MIN_PRIORITY（1）

主线程的优先级是5。
默认的线程对象优先级是5。

# 同步与死锁

线程同步：如何在多个线程访问同一资源的时候，保证数据的完整性。

同步会造成性能的降低。

解决同步问题的关键是锁。通过synchronized关键字实现。
- synchronized同步代码块
- 在方法定义上使用synchronized关键字（同步方法）

死锁是多线程同步中可能产生的问题，指若干个线程因为竞争共享资源而造成的互相等待的状态。

# 守护线程

守护线程围绕在用户线程周围。如果用户线程执行完毕，守护线程也就没有存在的必要。

最典型的守护线程：GC

Thread类里提供了守护线程的操作方法：
- 设置为守护线程：public final void setDaemon(boolean on);
- 判断是否为守护线程：public final boolean isDaemon();

# volatile关键字

主要用于属性定义，表示该属性为直接数据操作而不做引用处理。